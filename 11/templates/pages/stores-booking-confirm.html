<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Xác nhận đặt lịch - Pet Wow | Paw Joy</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23FDBA74'/%3E%3Cstop offset='100%25' stop-color='%23D97706'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='16' fill='url(%23grad)'/%3E%3Cg transform='translate(8 10) scale(0.75)'%3E%3Cpath fill='white' d='M32 36c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm-14-6c0 3.3 2.7 6 6 6s6-2.7 6-6-2.7-6-6-6-6 2.7-6 6zm28 0c0 3.3 2.7 6 6 6s6-2.7 6-6-2.7-6-6-6-6 2.7-6 6zm-20-12c0 3.3 2.7 6 6 6s6-2.7 6-6-2.7-6-6-6-6 2.7-6 6zm12 0c0 3.3 2.7 6 6 6s6-2.7 6-6-2.7-6-6-6-6 2.7-6 6z'/%3E%3C/g%3E%3C/svg%3E" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    
    <!-- Common CSS -->
    <link rel="stylesheet" href="../../assets/css/style.css" />
    <link rel="stylesheet" href="../../assets/css/christmas-theme.css" />
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Plus Jakarta Sans"', "sans-serif"],
              serif: ['"Playfair Display"', "serif"],
            },
            colors: {
              brand: "#D97706",
              brandLight: "#FFFBEB",
              brandDark: "#92400E",
              accent: "#059669",
              dark: "#3F2212",
              slate: "#1F2937",
              cream: "#FDFBF7",
              paper: "#F3F4F6",
            },
            boxShadow: {
              soft: "0 20px 40px -15px rgba(0, 0, 0, 0.05)",
            },
          },
        },
      };
    </script>

  </head>
  <body class="font-sans text-dark bg-cream antialiased">
    <!-- Christmas Snow Container -->
    <div id="snow-container" class="fixed inset-0 pointer-events-none z-10"></div>
    <!-- HEADER: logo, menu, điều hướng chính  -->
    <div id="header"></div>

    <!-- MAIN -->
    <main class="pt-20 md:pt-24 pb-8">
      <div class="container mx-auto px-6 max-w-6xl">
        <div class="bg-white rounded-2xl border border-gray-200 shadow-soft p-6 mb-6 flex items-center justify-between">
          <div>
            <h1 class="font-serif text-3xl font-bold text-dark">Xác nhận đặt lịch</h1>
            <p class="text-sm text-gray-500">Kiểm tra lại dịch vụ, thời gian và thông tin liên hệ.</p>
          </div>
          <div class="hidden sm:flex items-center gap-2 bg-brandLight/80 text-brand font-semibold px-3 py-2 rounded-full text-sm">
            <i class="fas fa-shield-dog"></i>
            <span>Giữ lịch an toàn</span>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <!-- LEFT -->
          <div class="lg:col-span-2 space-y-6">
            <!-- Services -->
            <div class="bg-white rounded-2xl border border-gray-200 p-5">
              <div class="flex items-center justify-between mb-4">
                <div>
                  <h2 class="font-serif text-2xl font-bold text-dark">Dịch vụ</h2>
                  <p class="text-sm text-gray-500">Những dịch vụ bạn đã chọn.</p>
                </div>
                <a href="stores-booking.html" class="text-sm text-brand font-semibold hover:underline">Chỉnh sửa</a>
              </div>
              <div id="confirmServices" class="space-y-3"></div>
            </div>

            <!-- Khuyến mãi -->
            <div class="bg-white rounded-2xl border border-gray-200 p-5">
              <h2 class="font-serif text-2xl font-bold text-dark mb-4">Khuyến mãi</h2>
              
              <!-- Khuyến mãi thường xuyên -->
              <div class="mb-4">
                <p class="text-sm font-semibold text-dark mb-3">Khuyến mãi đang áp dụng:</p>
                <div id="availablePromotions" class="space-y-2">
                  <!-- Sẽ được render bằng JavaScript -->
                </div>
              </div>

              <!-- Form nhập mã khuyến mãi riêng -->
              <div class="border-t border-gray-200 pt-4">
                <p class="text-sm font-semibold text-dark mb-3">Bạn có mã khuyến mãi riêng?</p>
                <div class="flex gap-2">
                  <input 
                    type="text" 
                    id="voucherCode" 
                    placeholder="Nhập mã khuyến mãi"
                    class="flex-1 px-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-brand"
                  />
                  <button 
                    onclick="applyVoucher()"
                    class="px-6 py-2 bg-brand hover:bg-brandDark text-white font-bold rounded-lg transition"
                  >
                    Áp dụng
                  </button>
                </div>
                <p id="voucherMessage" class="text-xs mt-2"></p>
              </div>
            </div>

            <!-- Sản phẩm nên mua kèm -->
            <div class="bg-white rounded-2xl border border-gray-200 p-5">
              <h2 class="font-serif text-2xl font-bold text-dark mb-4">Gợi ý mua kèm</h2>
              <p class="text-sm text-gray-500 mb-4">Những dịch vụ thường được đặt cùng:</p>
              <div id="suggestedServices" class="space-y-3">
                <!-- Sẽ được render bằng JavaScript -->
              </div>
            </div>

            <!-- Time -->
            <div class="bg-white rounded-2xl border border-gray-200 p-5">
              <div class="flex items-center justify-between mb-4">
                <div>
                  <h2 class="font-seri  f text-2xl font-bold text-dark">Thời gian</h2>
                  <p class="text-sm text-gray-500">Ngày giờ tại cửa hàng.</p>
                </div>
                <a href="stores-booking-time.html" class="text-sm text-brand font-semibold hover:underline">Chỉnh sửa</a>
              </div>
              <div id="confirmTime" class="p-4 bg-brandLight/80 rounded-xl border border-brand text-dark flex items-center gap-3">
                <i class="fas fa-paw text-brand text-lg"></i>
                <div>
                  <p id="confirmTimeValue" class="font-semibold text-dark"></p>
                  <p class="text-xs text-gray-600">Lịch có thể thay đổi tùy vào tình trạng thực tế tại cửa hàng.</p>
                </div>
              </div>
            </div>

            <!-- Contact -->
            <div class="bg-white rounded-2xl border border-gray-200 p-5 space-y-4">
              <div>
                <h2 class="font-serif text-2xl font-bold text-dark">Thông tin liên hệ</h2>
                <p class="text-sm text-gray-500">Chúng tôi sẽ liên hệ xác nhận.</p>
              </div>
              <div class="grid sm:grid-cols-2 gap-4">
                <div>
                  <label class="text-sm text-gray-600">Họ tên</label>
                  <input id="contactName" class="w-full mt-1 px-3 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-brand" placeholder="Tên của bạn" />
                </div>
                <div>
                  <label class="text-sm text-gray-600">Số điện thoại</label>
                  <input id="contactPhone" class="w-full mt-1 px-3 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-brand" placeholder="09xx..." />
                </div>
                <div class="sm:col-span-2">
                  <label class="text-sm text-gray-600">Ghi chú</label>
                  <textarea id="contactNote" class="w-full mt-1 px-3 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-brand" rows="3" placeholder="Yêu cầu đặc biệt cho thú cưng..."></textarea>
                </div>
              </div>
            </div>
          </div>

          <!-- RIGHT -->
          <div class="lg:col-span-1">
            <div class="sticky top-24 space-y-4">
              <div class="bg-white rounded-2xl border border-gray-200 p-5 space-y-3">
                <div class="flex items-start gap-3">
                  <div class="booking-store-image-container overflow-hidden rounded-lg">
                    <img
                      id="confirmStoreImage"
                      src=""
                      alt="Store"
                      class="w-16 h-16 rounded-lg object-cover booking-store-image"
                      onerror="this.src='../../assets/images/logo/LOGO PAWJOY.png'"
                    />
                  </div>
                  <div>
                    <h3 id="confirmStoreName" class="font-bold text-dark">Đang tải...</h3>
                    <p id="confirmStoreAddress" class="text-xs text-gray-600">Đang tải...</p>
                  </div>
                </div>
                <div class="border-t border-gray-200 pt-3 space-y-2 text-sm">
                  <div class="flex items-center justify-between">
                    <span class="font-semibold text-dark">Tổng dịch vụ</span>
                    <span id="confirmTotal" class="font-serif font-bold text-dark">0 VNĐ</span>
                  </div>
                  <div id="discountRow" class="flex items-center justify-between text-accent hidden">
                    <span class="font-semibold">Giảm giá</span>
                    <span id="discountAmount" class="font-serif font-bold">-0 VNĐ</span>
                  </div>
                  <div class="flex items-center justify-between">
                    <div class="flex items-center gap-1">
                      <span class="font-semibold text-dark">Phí dịch vụ</span>
                      <div class="relative group">
                        <i class="fas fa-question-circle text-gray-400 text-xs cursor-help"></i>
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-64 p-3 bg-gray-800 text-white text-xs rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none z-10">
                          Đây là phí giúp Paw Joy duy trì, nâng cao chất lượng trải nghiệm ứng dụng và đa dạng cửa hàng hơn
                          <div class="absolute top-full left-1/2 transform -translate-x-1/2 -mt-1">
                            <div class="w-2 h-2 bg-gray-800 rotate-45"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <span class="font-serif font-bold text-dark">15.000 VNĐ</span>
                  </div>
                  <div class="flex items-center justify-between border-t border-gray-200 pt-2">
                    <span class="font-bold text-dark">Tổng thanh toán tại cửa hàng</span>
                    <span id="confirmPay" class="font-serif font-bold text-brand text-lg">0 VNĐ</span>
                  </div>
                  <p class="text-xs text-gray-500 italic">
                    Tổng thanh toán tại cửa hàng không bao gồm phí trung gian.
                  </p>
                </div>
                <button
                  id="submitConfirm"
                  class="w-full bg-dark text-white font-bold py-3 rounded-xl hover:bg-brand transition"
                >
                  Xác nhận đặt lịch
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- FOOTER: thông tin liên hệ, chính sách, mạng xã hội -->
    <div id="footer" class="mt-16"></div>

    <!-- POPUP THANH TOÁN -->
    <div id="paymentModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
      <div class="bg-white rounded-2xl p-6 md:p-8 max-w-md w-full mx-4 shadow-2xl relative">
        <!-- Nút đóng -->
        <button
          onclick="closePaymentModal()"
          class="absolute top-4 right-4 text-gray-400 hover:text-dark transition"
        >
          <i class="fas fa-times text-xl"></i>
        </button>

        <!-- Header -->
        <div class="text-center mb-6">
          <div class="w-16 h-16 bg-brand/10 rounded-full flex items-center justify-center mx-auto mb-4">
            <i class="fas fa-qrcode text-brand text-3xl"></i>
          </div>
          <h3 class="font-serif text-2xl font-bold text-dark mb-2">Thanh toán phí dịch vụ</h3>
          <p class="text-sm text-gray-500">Quét mã QR để thanh toán phí trung gian</p>
        </div>

        <!-- Thông tin thanh toán -->
        <div class="bg-gray-50 rounded-xl p-4 mb-6">
          <div class="flex justify-between items-center mb-2">
            <span class="text-sm text-gray-600">Số tiền cần thanh toán:</span>
            <span id="paymentAmount" class="font-serif text-xl font-bold text-dark">15.000 VNĐ</span>
          </div>
          <div class="flex justify-between items-center text-xs text-gray-500">
            <span>Phí dịch vụ Paw Joy</span>
            <span>Mã đơn: <span id="orderCode" class="font-mono">PJ-2025-001</span></span>
          </div>
        </div>

        <!-- QR Code -->
        <div class="bg-white border-2 border-gray-200 rounded-xl p-6 mb-6 flex flex-col items-center">
          <div class="w-48 h-48 bg-white border-2 border-gray-300 rounded-lg flex items-center justify-center mb-4 relative overflow-hidden">
            <!-- QR Code từ API -->
            <img 
              id="qrCodeImage"
              src=""
              alt="QR Code"
              class="w-full h-full object-contain hidden"
            />
            <!-- QR Code fallback pattern -->
            <div id="qrCodePattern" class="grid grid-cols-8 gap-1 w-full h-full p-2">
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
              <div class="bg-black"></div>
              <div class="bg-white"></div>
              <div class="bg-white"></div>
              <div class="bg-black"></div>
            </div>
            <!-- Logo ở giữa QR code -->
            <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
              <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center">
                <i class="fas fa-paw text-brand text-xl"></i>
              </div>
            </div>
          </div>
          <p class="text-xs text-gray-500 text-center">
            Quét mã bằng ứng dụng ngân hàng hoặc ví điện tử
          </p>
        </div>

        <!-- Các phương thức thanh toán -->
        <div class="flex gap-2 justify-center mb-6">
          <div class="w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center">
            <i class="fab fa-cc-visa text-blue-600"></i>
          </div>
          <div class="w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center">
            <i class="fab fa-cc-mastercard text-red-600"></i>
          </div>
          <div class="w-10 h-10 bg-green-50 rounded-lg flex items-center justify-center">
            <i class="fas fa-mobile-alt text-green-600"></i>
          </div>
          <div class="w-10 h-10 bg-yellow-50 rounded-lg flex items-center justify-center">
            <i class="fab fa-cc-paypal text-yellow-600"></i>
          </div>
        </div>

        <!-- Button xác nhận thanh toán -->
        <button
          onclick="confirmPayment()"
          class="w-full bg-brand hover:bg-brandDark text-white font-bold py-4 rounded-xl transition shadow-lg"
        >
          <i class="fas fa-check-circle mr-2"></i>
          Xác nhận thanh toán
        </button>

        <p class="text-xs text-gray-400 text-center mt-4">
          Bằng cách thanh toán, bạn đồng ý với điều khoản sử dụng của Paw Joy
        </p>
      </div>
    </div>

    <!-- POPUP THANH TOÁN THÀNH CÔNG -->
    <div id="successModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
      <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl text-center">
        <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-check-circle text-green-600 text-4xl"></i>
        </div>
        <h3 class="font-serif text-2xl font-bold text-dark mb-2">Thanh toán thành công!</h3>
        <p class="text-gray-600 mb-6">
          Đơn đặt lịch của bạn đã được xác nhận. Chúng tôi sẽ liên hệ với bạn sớm nhất.
        </p>
        <div class="bg-gray-50 rounded-xl p-4 mb-6">
          <p class="text-sm text-gray-500 mb-1">Mã đơn hàng</p>
          <p id="successOrderCode" class="font-mono font-bold text-dark text-lg">PJ-2025-001</p>
        </div>
        <button
          onclick="closeSuccessModal()"
          class="w-full bg-brand hover:bg-brandDark text-white font-bold py-3 rounded-xl transition"
        >
          Hoàn tất
        </button>
      </div>
    </div>

    <script src="../../assets/js/Stores-booking-confirm.js"></script>
    <script>
      // Load header và footer từ các file component dùng chung
      document.addEventListener("DOMContentLoaded", () => {
        fetch("../../templates/partials/header.html")
          .then((res) => res.text())
          .then((html) => (document.getElementById("header").innerHTML = html));

        fetch("../../templates/partials/footer.html")
          .then((res) => res.text())
          .then((html) => (document.getElementById("footer").innerHTML = html));
      });
    </script>
    <script type="module" src="../../assets/js/lib/mobile-menu.js"></script>
    <script type="module" src="../../assets/js/lib/footer.js"></script>
    <script src="../../assets/js/scroll.js"></script>
    <script src="../../assets/js/christmas-snow.js"></script>
  </body>
</html>

